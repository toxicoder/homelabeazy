<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Configuration</title>
  <link rel="stylesheet" href="/homelabeazy/assets/css/style.css">
</head><body>
  <div class="container">
    <h1 id="configuration">Configuration</h1>

<p>Configuration for this project is stored in a private Git repository that you control. The <code class="language-plaintext highlighter-rouge">make setup-interactive</code> script will generate the initial configuration files and commit them to your repository.</p>

<p>The configuration is split into several types of files:</p>

<ol>
  <li><strong>Global Settings:</strong> A <code class="language-plaintext highlighter-rouge">config.yml</code> file contains high-level settings for your homelab.</li>
  <li><strong>Terraform Variables:</strong> A <code class="language-plaintext highlighter-rouge">terraform.tfvars</code> file contains variables specific to the Proxmox infrastructure.</li>
  <li><strong>Ansible Inventory:</strong> An Ansible inventory file tells Ansible which hosts to connect to.</li>
  <li><strong>Application Configuration:</strong> An <code class="language-plaintext highlighter-rouge">apps/</code> directory contains <code class="language-plaintext highlighter-rouge">values.yaml</code> files for each application, which are used to configure the Helm charts deployed by ArgoCD.</li>
</ol>

<p>During the setup process, the <code class="language-plaintext highlighter-rouge">homelabeazy</code> repository will create a symlink named <code class="language-plaintext highlighter-rouge">private</code> that points to your private configuration directory. This allows the tools in this repository to access your configuration.</p>

<h2 id="1-global-configuration-configyml">1. Global Configuration (<code class="language-plaintext highlighter-rouge">config.yml</code>)</h2>

<p>This file is the central place for all your high-level configuration. It is generated by the <code class="language-plaintext highlighter-rouge">homelab-importer</code> tool during the interactive setup.</p>

<table>
  <thead>
    <tr>
      <th>Variable</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.domain_name</code></td>
      <td>The domain name for your homelab (e.g., <code class="language-plaintext highlighter-rouge">homelab.local</code>).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.timezone</code></td>
      <td>The timezone for the servers (e.g., <code class="language-plaintext highlighter-rouge">Etc/UTC</code>).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.load_balancer_ip</code></td>
      <td>The IP address to be used by the Kubernetes load balancer.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.proxmox_node</code></td>
      <td>The name of the Proxmox node to deploy to.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.proxmox_template</code></td>
      <td>The name of the cloud-init template to use for new VMs.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.proxmox_service_bridge</code></td>
      <td>The Proxmox network bridge for the service network.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.proxmox_service_vlan_tag</code></td>
      <td>The VLAN tag for the service network.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.k3s_master_vm_id</code></td>
      <td>The VM ID for the K3s master node.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.k3s_worker_vm_id_start</code></td>
      <td>The starting VM ID for the K3s worker nodes.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">common.ldap_base_dn</code></td>
      <td>The base DN for the LDAP server.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">secrets_to_generate</code></td>
      <td>A list of secrets to be generated by the <code class="language-plaintext highlighter-rouge">secure_gen</code> role.</td>
    </tr>
  </tbody>
</table>

<h2 id="2-terraform-variables-terraformtfvars">2. Terraform Variables (<code class="language-plaintext highlighter-rouge">terraform.tfvars</code>)</h2>

<p>This file holds the variables needed by Terraform to provision the infrastructure on Proxmox. The <code class="language-plaintext highlighter-rouge">homelab-importer</code> tool will generate this file based on your existing Proxmox environment.</p>

<table>
  <thead>
    <tr>
      <th>Variable</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">proxmox_api_url</code></td>
      <td>The URL of your Proxmox API (e.g., <code class="language-plaintext highlighter-rouge">https://proxmox.example.com/api2/json</code>).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pm_token_id</code></td>
      <td>Your Proxmox API token ID.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">pm_token_secret</code></td>
      <td>Your Proxmox API token secret.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">proxmox_node</code></td>
      <td>The name of the Proxmox node to deploy to.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">proxmox_template</code></td>
      <td>The name of the cloud-init template to use for the VMs.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">k3s_worker_count</code></td>
      <td>The number of K3s worker nodes to create. Defaults to <code class="language-plaintext highlighter-rouge">1</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">k3s_master_memory</code></td>
      <td>The amount of memory (in MB) for the master VM. Defaults to <code class="language-plaintext highlighter-rouge">2048</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">k3s_master_cores</code></td>
      <td>The number of CPU cores for the master VM. Defaults to <code class="language-plaintext highlighter-rouge">2</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">k3s_worker_memory</code></td>
      <td>The amount of memory (in MB) for the worker VMs. Defaults to <code class="language-plaintext highlighter-rouge">2048</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">k3s_worker_cores</code></td>
      <td>The number of CPU cores for the worker VMs. Defaults to <code class="language-plaintext highlighter-rouge">22</code>.</td>
    </tr>
  </tbody>
</table>

<h2 id="3-ansible-inventory">3. Ansible Inventory</h2>

<p>The Ansible inventory file (<code class="language-plaintext highlighter-rouge">ansible/inventory/inventory.auto.yml</code>) is generated automatically when you run the interactive setup. The script uses the output of <code class="language-plaintext highlighter-rouge">terraform output -json</code> to create the inventory file.</p>

  </div>
</body>
</html>
