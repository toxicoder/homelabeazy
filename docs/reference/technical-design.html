<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/homelabeazy/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/homelabeazy/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(5)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(5) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(5) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(5) > ul.nav-list { display: block; }</style><script src="/homelabeazy/assets/js/vendor/lunr.min.js"></script> <script src="/homelabeazy/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Technical Design | Homelabeazy Documentation</title><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Technical Design" /><meta property="og:locale" content="en" /><meta name="description" content="“Your Homelab as Code”" /><meta property="og:description" content="“Your Homelab as Code”" /><link rel="canonical" href="https://toxicoder.github.io/homelabeazy/docs/reference/technical-design.html" /><meta property="og:url" content="https://toxicoder.github.io/homelabeazy/docs/reference/technical-design.html" /><meta property="og:site_name" content="Homelabeazy Documentation" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Technical Design" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"“Your Homelab as Code”","headline":"Technical Design","url":"https://toxicoder.github.io/homelabeazy/docs/reference/technical-design.html"}</script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/homelabeazy/" class="site-title lh-tight"> Homelabeazy Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Guides category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/homelabeazy/docs/guides/" class="nav-list-link">Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/homelabeazy/docs/guides/advanced-usage.html" class="nav-list-link">Advanced Usage</a><li class="nav-list-item"><a href="/homelabeazy/docs/guides/customization.html" class="nav-list-link">Customization</a><li class="nav-list-item"><a href="/homelabeazy/docs/guides/getting-started.html" class="nav-list-link">Getting Started</a><li class="nav-list-item"><a href="/homelabeazy/docs/guides/troubleshooting.html" class="nav-list-link">Troubleshooting</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Reference category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/homelabeazy/docs/reference/" class="nav-list-link">Reference</a><ul class="nav-list"><li class="nav-list-item"><a href="/homelabeazy/docs/reference/configuration.html" class="nav-list-link">Configuration</a><li class="nav-list-item"><a href="/homelabeazy/docs/reference/deployment.html" class="nav-list-link">Deployment</a><li class="nav-list-item"><a href="/homelabeazy/docs/reference/folder-structure.html" class="nav-list-link">Folder Structure</a><li class="nav-list-item"><a href="/homelabeazy/docs/reference/services.html" class="nav-list-link">Services</a><li class="nav-list-item"><a href="/homelabeazy/docs/reference/technical-design.html" class="nav-list-link">Technical Design</a></ul><li class="nav-list-item"><a href="/homelabeazy/docs/community.html" class="nav-list-link">Community</a><li class="nav-list-item"><a href="/homelabeazy/" class="nav-list-link">Welcome to Homelabeazy</a></ul><ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/toxicoder/homelabeazy" class="nav-list-link external" > Homelabeazy on GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Homelabeazy Documentation" aria-label="Search Homelabeazy Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="https://github.com/toxicoder/homelabeazy" class="site-button" > Homelabeazy on GitHub </a></ul></nav></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/homelabeazy/docs/reference/">Reference</a><li class="breadcrumb-nav-list-item"><span>Technical Design</span></ol></nav><div id="main-content" class="main-content"><main><h1 id="technical-design-document"> <a href="#technical-design-document" class="anchor-heading" aria-labelledby="technical-design-document"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Technical Design Document</h1><h2 id="1-introduction"> <a href="#1-introduction" class="anchor-heading" aria-labelledby="1-introduction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Introduction</h2><p>Welcome to the Technical Design Document for Homelabeazy. This document provides a detailed technical overview of the project, from its high-level architecture down to the individual components. Whether you’re a user who wants to understand the inner workings of your homelab, or a contributor who wants to help improve the project, this document will serve as your guide.</p><h3 id="who-is-this-for"> <a href="#who-is-this-for" class="anchor-heading" aria-labelledby="who-is-this-for"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Who is this for?</h3><p>This document is intended for users who have a basic understanding of the core technologies used in this project, such as Proxmox, Terraform, Ansible, and Kubernetes. If you’re new to these technologies, we recommend that you start with our <a href="/homelabeazy/docs/guides/getting-started.html">Getting Started guide</a> and then come back to this document for a deeper dive.</p><h3 id="design-philosophy"> <a href="#design-philosophy" class="anchor-heading" aria-labelledby="design-philosophy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Design Philosophy</h3><p>The design of Homelabeazy is guided by a set of core principles that are common in modern DevOps and Site Reliability Engineering (SRE) practices:</p><ul><li><strong>Infrastructure as Code (IaC):</strong> All infrastructure is defined as code, which allows for automation, versioning, and reproducibility.<li><strong>GitOps:</strong> Git is the single source of truth for both infrastructure and applications. All changes are made through pull requests, which provides a clear audit trail and enables collaboration.<li><strong>Modularity:</strong> The project is designed to be modular, so that you can easily add or remove components to suit your needs.<li><strong>Security by Design:</strong> Security is a primary consideration in all aspects of the project, from network segmentation to secrets management.</ul><hr /><h2 id="2-goals-and-non-goals"> <a href="#2-goals-and-non-goals" class="anchor-heading" aria-labelledby="2-goals-and-non-goals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Goals and Non-Goals</h2><h3 id="21-goals"> <a href="#21-goals" class="anchor-heading" aria-labelledby="21-goals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.1. Goals</h3><p>The primary goals of this project are to:</p><ul><li><strong>Provide a complete blueprint for a modern homelab:</strong> This project aims to be a comprehensive guide for building a powerful and flexible homelab environment.<li><strong>Automate everything:</strong> From the provisioning of virtual machines to the deployment of applications, every aspect of the homelab should be automated.<li><strong>Ensure reproducibility:</strong> You should be able to tear down and rebuild your entire homelab from scratch in a consistent and predictable manner.<li><strong>Promote best practices:</strong> This project aims to demonstrate and encourage the use of enterprise-grade best practices for infrastructure management, such as IaC, GitOps, and security by design.<li><strong>Be highly customizable:</strong> You should be able to easily customize the project to meet your specific needs, whether you want to add new applications, change the network configuration, or integrate with other systems.</ul><h3 id="22-non-goals"> <a href="#22-non-goals" class="anchor-heading" aria-labelledby="22-non-goals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2.2. Non-Goals</h3><p>This project does not aim to:</p><ul><li><strong>Be a one-size-fits-all solution:</strong> While the project is highly customizable, it is not intended to be a universal solution for every homelab. It is designed for a specific set of technologies and use cases.<li><strong>Support other virtualization platforms:</strong> The project is tightly coupled with Proxmox and does not support other hypervisors like ESXi or Hyper-V out of the box. However, the modular design of the project would allow for the addition of other providers in the future.<li><strong>Be a beginner-friendly project:</strong> While we strive to make the documentation as clear as possible, a certain level of technical understanding of the core components (Terraform, Ansible, Kubernetes) is expected.<li><strong>Be a production-ready enterprise solution:</strong> While this project uses enterprise-grade practices, it is intended for personal homelab use and is not recommended for production enterprise workloads without significant additional hardening and testing.</ul><hr /><h2 id="3-system-architecture"> <a href="#3-system-architecture" class="anchor-heading" aria-labelledby="3-system-architecture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. System Architecture</h2><p>The architecture of Homelabeazy is a multi-layered system that builds upon a foundation of virtualization. It uses a combination of IaC and GitOps tools to automate the provisioning and configuration of a Kubernetes cluster and the applications that run on it.</p><div class="mermaid"> graph TD subgraph "Hardware" A[Physical Server] end subgraph "Virtualization" B(Proxmox VE) end subgraph "Automation" C(Terraform) -- Provisions VMs on --&gt; B D(Ansible) -- Configures Nodes --&gt; E end subgraph "Container Orchestration &amp; GitOps" E(K3s Kubernetes Cluster) K(ArgoCD) -- Deploys Apps to --&gt; E L(Git Repository) -- Syncs with --&gt; K end subgraph "Applications" F[Core Services] G[User Applications] end subgraph "Supporting Services" H(Traefik Ingress) I(Authelia SSO) J(Vault Secrets) end A --&gt; B B --&gt; E E -- Runs --&gt; F E -- Runs --&gt; G F -- Exposed by --&gt; H G -- Exposed by --&gt; H G -- Authenticated by --&gt; I E -- Uses --&gt; J</div><h3 id="system-architecture-walkthrough"> <a href="#system-architecture-walkthrough" class="anchor-heading" aria-labelledby="system-architecture-walkthrough"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Architecture Walkthrough</h3><p>The system architecture is designed to be a robust, scalable, and automated homelab environment. Here’s a step-by-step walkthrough of the diagram, explaining the role and value of each component:</p><ol><li><p><strong>Hardware (Physical Server):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Physical Server
</pre></table></div></code><li><strong>Role:</strong> This is the foundation of the entire homelab, providing the necessary compute, memory, and storage resources.<li><strong>Value:</strong> A dedicated physical server ensures that all virtualized components have direct access to high-performance hardware, leading to better overall performance and stability.</ul><li><p><strong>Virtualization (Proxmox VE):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Proxmox VE
</pre></table></div></code><li><strong>Role:</strong> Proxmox is an open-source virtualization platform that runs on the physical server. It allows for the creation and management of virtual machines (VMs) and containers.<li><strong>Value:</strong> Proxmox enables efficient hardware utilization by allowing multiple isolated environments to run on a single physical machine. This is crucial for creating a flexible and scalable infrastructure.</ul><li><p><strong>Automation (Terraform &amp; Ansible):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Terraform
</pre></table></div></code> &amp; <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Ansible
</pre></table></div></code><li><strong>Role:</strong><ul><li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Terraform
</pre></table></div></code> is used to provision the virtual machines on Proxmox. It defines the infrastructure as code, making it easy to create, modify, and destroy VMs in a repeatable manner.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Ansible
</pre></table></div></code> is used for configuration management. Once the VMs are provisioned, Ansible configures them and installs the necessary software like K3s.</ul><li><strong>Value:</strong> This combination of tools automates the entire setup process, reducing manual effort and ensuring consistency. It allows you to rebuild the entire homelab from scratch with minimal intervention.</ul><li><p><strong>Container Orchestration &amp; GitOps (K3s &amp; ArgoCD):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>K3s Kubernetes Cluster
</pre></table></div></code> &amp; <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ArgoCD
</pre></table></div></code><li><strong>Role:</strong><ul><li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>K3s
</pre></table></div></code> is a lightweight, certified Kubernetes distribution that runs on the VMs. It orchestrates the deployment, scaling, and management of containerized applications.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ArgoCD
</pre></table></div></code> provides a GitOps workflow. It continuously monitors a Git repository and automatically deploys any changes to the K3s cluster, ensuring that the cluster state always matches the state defined in Git.</ul><li><strong>Value:</strong> Kubernetes provides a powerful and standardized platform for running applications. ArgoCD automates application deployment and management, making it easy to track changes, roll back to previous versions, and maintain a consistent environment.</ul><li><p><strong>Applications (Core Services &amp; User Applications):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Core Services
</pre></table></div></code> &amp; <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>User Applications
</pre></table></div></code><li><strong>Role:</strong> The K3s cluster runs two types of applications:<ul><li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Core Services
</pre></table></div></code>: These are essential infrastructure components like monitoring, logging, and security services.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>User Applications
</pre></table></div></code>: These are the end-user applications that you want to run in your homelab, such as a password manager, Git service, or home automation platform.</ul><li><strong>Value:</strong> This separation allows you to manage the core infrastructure independently of the applications, making it easier to update and maintain both.</ul><li><p><strong>Supporting Services (Traefik, Authelia, Vault):</strong></p><ul><li><strong>Component:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Traefik Ingress
</pre></table></div></code>, <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Authelia SSO
</pre></table></div></code>, <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Vault Secrets
</pre></table></div></code><li><strong>Role:</strong><ul><li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Traefik Ingress
</pre></table></div></code>: A reverse proxy and load balancer that manages external access to the applications running in the cluster.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Authelia SSO
</pre></table></div></code>: Provides single sign-on and two-factor authentication for the applications, enhancing security.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Vault Secrets
</pre></table></div></code>: A secure storage for secrets like API keys, passwords, and certificates.</ul><li><strong>Value:</strong> These services provide essential functionality for managing and securing the applications. Traefik simplifies routing, Authelia centralizes authentication, and Vault protects sensitive information.</ul></ol><h3 id="general-flow-of-the-system"> <a href="#general-flow-of-the-system" class="anchor-heading" aria-labelledby="general-flow-of-the-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General Flow of the System</h3><ol><li><strong>Provisioning:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Terraform
</pre></table></div></code> provisions the virtual machines on <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Proxmox
</pre></table></div></code>.<li><strong>Configuration:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Ansible
</pre></table></div></code> configures the VMs and installs the <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>K3s Kubernetes Cluster
</pre></table></div></code>.<li><strong>Deployment:</strong> <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ArgoCD
</pre></table></div></code> monitors the Git repository and deploys the <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Core Services
</pre></table></div></code> and <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>User Applications
</pre></table></div></code> to the <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>K3s
</pre></table></div></code> cluster.<li><strong>Access:</strong><ul><li>Users access the applications through the <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Traefik Ingress
</pre></table></div></code>.<li><code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Authelia SSO
</pre></table></div></code> intercepts the requests to handle authentication.</ul><li><strong>Secrets Management:</strong> The applications and the cluster use <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Vault
</pre></table></div></code> to securely retrieve their secrets.</ol><hr /><h2 id="4-detailed-component-design"> <a href="#4-detailed-component-design" class="anchor-heading" aria-labelledby="4-detailed-component-design"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Detailed Component Design</h2><h3 id="41-proxmox"> <a href="#41-proxmox" class="anchor-heading" aria-labelledby="41-proxmox"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.1. Proxmox</h3><ul><li><strong>Why Proxmox?</strong> Proxmox was chosen for its rich feature set, its open-source nature, and its excellent API support, which is crucial for automation.<li><strong>Prerequisites:</strong> A working Proxmox installation is required.<li><strong>VM Templates:</strong> The project relies on a cloud-init compatible VM template to be present on the Proxmox server. This template is used by Terraform to clone new VMs. The template should be a minimal installation of a supported OS (e.g., Ubuntu Server).</ul><h3 id="42-terraform"> <a href="#42-terraform" class="anchor-heading" aria-labelledby="42-terraform"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.2. Terraform</h3><ul><li><strong>Why Terraform?</strong> Terraform is a popular and powerful IaC tool that allows you to define your infrastructure in a declarative way. It has excellent support for Proxmox and a wide range of other providers.<li><strong>Configuration:</strong> The main configuration file is <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>main.tf
</pre></table></div></code>, which defines the Proxmox provider and the VM resources.<li><strong>Variables:</strong> User-specific variables, such as Proxmox API credentials and VM specifications (CPU, memory, disk), are defined in <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>variables.tf
</pre></table></div></code> and should be set in a <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform.tfvars
</pre></table></div></code> file.</ul><h3 id="43-ansible"> <a href="#43-ansible" class="anchor-heading" aria-labelledby="43-ansible"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.3. Ansible</h3><ul><li><strong>Why Ansible?</strong> Ansible is a simple and powerful configuration management tool that is agentless, which means that you don’t need to install any special software on the managed nodes.<li><strong>Inventory:</strong> Ansible’s inventory is located in <code class="language-plaintext highlighter-rouge"><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ansible/inventory/
</pre></table></div></code>. A static inventory file is provided for the user to fill in with the IP addresses of the newly created VMs.<li><strong>Playbooks and Roles:</strong> The project uses a combination of playbooks and roles to organize the Ansible code. This modular structure allows for easy extension and customization.</ul><h3 id="44-k3s-cluster"> <a href="#44-k3s-cluster" class="anchor-heading" aria-labelledby="44-k3s-cluster"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.4. K3s Cluster</h3><ul><li><strong>Why K3s?</strong> K3s is designed to be a single binary that is easy to install, manage, and scale. It is a great choice for homelab environments where resources may be limited.<li><strong>Architecture:</strong> The cluster consists of one or more master nodes and one or more worker nodes.<li><strong>Storage:</strong> The project is configured to use the default K3s storage provisioner (local-path-provisioner), which is suitable for single-node clusters or development environments. For multi-node clusters, a more robust storage solution like Longhorn or an NFS provisioner would be recommended.</ul><h3 id="45-argocd"> <a href="#45-argocd" class="anchor-heading" aria-labelledby="45-argocd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.5. ArgoCD</h3><ul><li><strong>Why ArgoCD?</strong> ArgoCD is a popular and powerful GitOps tool that provides a clear and intuitive way to manage your applications.<li><strong>App of Apps Pattern:</strong> The project uses the “app of apps” pattern, which allows for modular management of applications.</ul><h3 id="46-networking"> <a href="#46-networking" class="anchor-heading" aria-labelledby="46-networking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.6. Networking</h3><p>The project uses a VLAN-based network segmentation strategy to isolate traffic and enhance security.</p><ul><li><strong>Traefik:</strong> Traefik is a modern reverse proxy and load balancer that is used as the Ingress controller for the K3s cluster.<li><strong>Consul:</strong> Consul is used for service discovery within the cluster.<li><strong>pfSense:</strong> pfSense is a powerful open-source firewall and router that is used to manage the network.</ul><h3 id="47-security"> <a href="#47-security" class="anchor-heading" aria-labelledby="47-security"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.7. Security</h3><ul><li><strong>Vault:</strong> HashiCorp Vault is used for secrets management.<li><strong>Authelia:</strong> Authelia is an open-source authentication and authorization server providing two-factor authentication and single sign-on (SSO).<li><strong>OpenLDAP:</strong> OpenLDAP is used as the central user directory.</ul><h3 id="48-monitoring-and-logging"> <a href="#48-monitoring-and-logging" class="anchor-heading" aria-labelledby="48-monitoring-and-logging"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.8. Monitoring and Logging</h3><ul><li><strong>EFK Stack:</strong> The project uses the EFK stack (Elasticsearch, Fluentd, and Kibana) for centralized logging.</ul><h3 id="49-backup-and-recovery"> <a href="#49-backup-and-recovery" class="anchor-heading" aria-labelledby="49-backup-and-recovery"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4.9. Backup and Recovery</h3><ul><li><strong>Velero:</strong> Velero is used for backing up and restoring the Kubernetes cluster.</ul><hr /><h2 id="5-scalability-and-customization"> <a href="#5-scalability-and-customization" class="anchor-heading" aria-labelledby="5-scalability-and-customization"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. Scalability and Customization</h2><p>This project is designed to be both scalable and customizable. You can easily scale your cluster by adding more worker nodes, and you can customize the project by adding your own applications, configuring services, and modifying the infrastructure. For detailed instructions, please refer to the <a href="/homelabeazy/docs/guides/customization.html">Customization Guide</a>.</p><hr /><h2 id="6-roadmap"> <a href="#6-roadmap" class="anchor-heading" aria-labelledby="6-roadmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6. Roadmap</h2><p>This project is continuously evolving. Here are some potential future enhancements:</p><ul><li><strong>Multi-Cloud Support:</strong> Adding support for other cloud providers like AWS, GCP, or Azure.<li><strong>Advanced Networking:</strong> Implementing more advanced networking policies using a service mesh like Istio or Linkerd.<li><strong>High Availability:</strong> Setting up a multi-master K3s cluster for high availability of the control plane.<li><strong>Automated Backups:</strong> Creating a more automated backup and restore workflow.</ul></main></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.3/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
