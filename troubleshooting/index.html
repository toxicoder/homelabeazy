<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Troubleshooting</title>
  <link rel="stylesheet" href="/homelabeazy/assets/css/style.css">
</head><body>
  <div class="container">
    <h1 id="troubleshooting">Troubleshooting</h1>

<p>This section provides solutions to common problems you may encounter during the setup process.</p>

<h2 id="scriptssetupsh-script-fails"><code class="language-plaintext highlighter-rouge">scripts/setup.sh</code> Script Fails</h2>

<p>If the <code class="language-plaintext highlighter-rouge">scripts/setup.sh</code> script fails, it is most likely due to an issue with the Terraform or Ansible commands that it is running. To debug the issue, you can run the commands manually and inspect the output.</p>

<ol>
  <li><strong>Run Terraform manually:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>terraform
terraform init
terraform plan
terraform apply
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Run Ansible manually:</strong>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cd </span>ansible
ansible-playbook <span class="nt">-i</span> inventory/inventory.auto.yml playbooks/main.yml
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
</ol>

<h2 id="terraform-fails-to-apply-changes">Terraform Fails to Apply Changes</h2>

<p>If Terraform fails to apply the changes, it may be due to a problem with your Proxmox environment. Check the following:</p>

<ul>
  <li><strong>Proxmox API Token:</strong> Make sure your Proxmox API token has the correct permissions.</li>
  <li><strong>Proxmox Host:</strong> Make sure the Proxmox host is running and accessible.</li>
  <li><strong>Cloud-init Template:</strong> Make sure the cloud-init template exists and is configured correctly.</li>
</ul>

<h2 id="ansible-playbook-fails-to-run">Ansible Playbook Fails to Run</h2>

<p>If the Ansible playbook fails to run, it may be due to a problem with your SSH connection. Check the following:</p>

<ul>
  <li><strong>SSH Key:</strong> Make sure your SSH key is added to your SSH agent.</li>
  <li><strong>SSH Connection:</strong> Make sure you can connect to the nodes using SSH.</li>
</ul>

<h2 id="application-is-not-accessible">Application Is Not Accessible</h2>

<p>If an application is not accessible, it may be due to a problem with the Traefik Ingress controller or the application itself.</p>

<ul>
  <li><strong>Check the Traefik Dashboard:</strong> The Traefik dashboard will show you the status of your Ingress routes and whether there are any errors.</li>
  <li><strong>Check the Application Logs:</strong> Use <code class="language-plaintext highlighter-rouge">kubectl logs</code> to check the logs of the application’s pods. This will often give you a clue as to what is wrong.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>&lt;app-name&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Check the Ingress Route:</strong> Make sure the Ingress route for the application is configured correctly.
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>kubectl get ingressroute <span class="nt">-n</span> &lt;namespace&gt;
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li><strong>Check DNS:</strong> Make sure the DNS record for the application is pointing to the correct IP address.</li>
</ul>

<h2 id="restarting-the-setup-process">Restarting the Setup Process</h2>

<p>If you encounter an issue that you cannot resolve, you can restart the setup process from the beginning.</p>

<ol>
  <li>
    <p><strong>Destroy the infrastructure:</strong></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make destroy
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Delete the <code class="language-plaintext highlighter-rouge">terraform.tfvars</code> file:</strong></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm </span>infrastructure/proxmox/terraform.tfvars
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Delete the <code class="language-plaintext highlighter-rouge">ansible/inventory/inventory.auto.yml</code> file:</strong></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">rm </span>ansible/inventory/inventory.auto.yml
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Run the setup process again by following the steps in the “Getting Started” section.</strong></p>
  </li>
</ol>

  </div>
</body>
</html>
